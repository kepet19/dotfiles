#vim:filetype=i3
set $mod mod4
set $term --no-startup-id $TERMINAL
# font pango: mononok Nerd Font Mono Regular 11
font "pango:FiraCode Nerd Font 11"
output * subpixel rgb

# Load pywal colors
include "$HOME/.cache/wal/colors-sway"

# Remov when chaning do default sway
border_images.focused "$HOME/.local/share/sway-borders/shadows.png"
border_images.focused_inactive "$HOME/.local/share/sway-borders/shadows.png"
border_images.unfocused "$HOME/.local/share/sway-borders/shadows.png"
border_images.urgent "$HOME/.local/share/sway-borders/shadows_red.png"

# hide_cursor
seat * hide_cursor 4000

input * {
# xkb_layout "dk"
xkb_layout "us"
xkb_variant altgr-intl
repeat_rate 45
repeat_delay 300
# xkb_options "grp:win_space_toggle"
# xkb_file /home/kkmp/.config/sway/keymap.xkb
xkb_numlock enable
xkb_capslock disable
# natural_scroll disable
accel_profile flat
scroll_factor 1
# xkb_options super_L:super_L,escape
# xkb_options caps:escape
}



# Trackpad input Settings
input "1739:0:Synaptics_TM2668-002" {
tap enabled
natural_scroll enabled
scroll_factor 0.3
}
input "2:7:SynPS/2_Synaptics_TouchPad" {
   	# tap enabled
natural_scroll enabled
scroll_factor 0.3
}

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

# ------------------- wayvnc | seat or group --------------------
# Putting wayvnc in its own seat is done like this:
# swaymsg seat wayvnc fallback false # create a new seat
seat wayvnc fallback false
exec wayvnc --seat=wayvnc

# Smart keyboard grouping can be turned off like this:
# swaymsg seat seat0 keyboard_grouping none

# ------------------- dmenu | rofi ------------------------------
# Your preferred application launcher
# Note: pass the final command to swaymsg so that the resulting window can be opened
# on the original workspace that the command was run on.
set $menu dmenu_path | bemenu -n | xargs swaymsg exec --
set $menu_rofi rofi -show drun -lines 10 -matching fuzzy -color-enabled -show-icons
set $menu_rofi_ssh rofi -show ssh -lines 10 -matching fuzzy -color-enabled -show-icons

# start a terminal
bindsym $mod+Return exec $TERMINAL
bindsym $mod+shift+Return exec $TERMINAL -e tmux

# https://github.com/ArtsyMacaw/wlogout LOGOUT
bindsym $mod+F4 exec wlogout
bindsym $mod+Backspace exec wlogout

bindsym $mod+q kill

# Bind Appclications
bindsym $mod+w              exec $TERMINAL -t "float_nmtui" -e nmtui
bindsym $mod+Shift+w        exec --no-startup-id $BROWSER
bindsym $mod+e              exec $FILE
bindsym $mod+Shift+m exec makoctl menu bemenu -p 'Select Action'
bindsym $mod+r exec $menu
bindsym $mod+Shift+r        exec wf-recorder-pick
bindsym $mod+p			    exec wdisplays
bindsym $mod+Shift+p	    exec grimcolor
bindsym alt+shift+p	        exec grimpick
bindsym alt+p               exec grimselect


# nwg-menu
bindsym $mod+s exec nwg-menu
# bindcode 133 exec nwg-menu


# Bind for moving windows
bindsym $mod+h			focus left
bindsym $mod+Left 		focus left
bindsym $mod+Shift+h		move left
bindsym $mod+Ctrl+h		move workspace to output left
bindsym $mod+Shift+y		exec --no-startup-id i3resize left

bindsym $mod+j			focus down
bindsym $mod+Down 		focus down
bindsym $mod+Shift+j		move down
bindsym $mod+Ctrl+j		move workspace to output down
bindsym $mod+Shift+u		exec --no-startup-id i3resize down

bindsym $mod+k			focus up
bindsym $mod+Up 		focus up
bindsym $mod+Shift+k		move up
bindsym $mod+Ctrl+k		move workspace to output up
bindsym $mod+Shift+i		exec --no-startup-id i3resize up

bindsym $mod+l			focus right
bindsym $mod+Right 		focus right
bindsym $mod+Shift+l		move right
bindsym $mod+Ctrl+l		move workspace to output right
bindsym $mod+Shift+o		exec --no-startup-id i3resize right

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen toggle
bindsym $mod+shift+f sticky toggle

# todo
for_window [title="dropdown_todo"] {
    move scratchpad
    resize set 1024 450
    move absolute position 750 60
}
bindsym $mod+n exec swaymsg [title="dropdown_todo"] scratchpad show || $(exec $TERMINAL -t 'dropdown_todo' -e nvim "$HOME/Documents/todo.md" & sleep 0.2 && swaymsg '[title="dropdown_todo"] scratchpad show')

# ncspot
for_window [title="dropdown_ncspot"] {
    move scratchpad
        resize set 1024 768
        move absolute position 1400 600
}
bindsym $mod+m exec swaymsg [title="dropdown_ncspot"] scratchpad show || $(exec $TERMINAL -t 'dropdown_ncspot' -e ncspot & sleep 0.2 && swaymsg '[title="dropdown_ncspot"] scratchpad show')

# todos
for_window [title="^Todos - Iced$"] {
    move scratchpad
        resize set 400 700
        move absolute position 1400 600
}
bindsym $mod+i exec swaymsg '[title="^Todos - Iced$"] scratchpad show' || $(exec todos & sleep 0.2 && swaymsg '[title="^Todos - Iced$"] scratchpad show')

# floating terminal
for_window [title="dropdown_term"] {
    move scratchpad
        resize set 1024 450
        move absolute position 750 60
}
bindsym $mod+u exec swaymsg [title="dropdown_term"] scratchpad show || $(exec $TERMINAL -t 'dropdown_term' -e tmuxdd & sleep 0.2 && swaymsg '[title="dropdown_term"] scratchpad show')

# bitwarden
for_window [class="Bitwarden"] {
    move scratchpad
        resize set 780 415
}
bindsym $mod+b exec swaymsg [class="Bitwarden"] scratchpad show || $(exec bitwarden & sleep 0.2 && swaymsg [class="Bitwarden"] scratchpad show)

# calcurse
for_window [title="console_calender"] {
    move scratchpad
        floating enable
        resize set 800 600
        move position 800 20
}
bindsym $mod+c exec swaymsg [title="console_calender"] scratchpad show || $(exec $TERMINAL -t 'console_calender' -e calcurse & sleep 0.2 && swaymsg [title="console_calender"] scratchpad show)

# calculator
for_window [app_id="gnome-calculator"] {
    move scratchpad
        floating enable
        resize set 800 600
}
bindsym $mod+a exec swaymsg [app_id="gnome-calculator"] scratchpad show || $(exec gnome-calculator & sleep 0.4 && swaymsg [app_id="gnome-calculator"] scratchpad show)


# pavucontrol
    for_window [app_id="pavucontrol"] {
        move scratchpad
        floating enable
        resize set 550 1000
        move position $xsize 20
    }
    bindsym $mod+o exec swaymsg [app_id="pavucontrol"] scratchpad show || $(exec pavucontrol & sleep 0.2 && swaymsg [app_id="pavucontrol"] scratchpad show)

# Inhibit Idle if a window is fullscreen
for_window [class="^.*"] inhibit_idle fullscreen
for_window [app_id="^.*"] inhibit_idle fullscreen

# FLOATING APPS:
for_window [class="Pinentry"] sticky enable
for_window [class="net-minecraft-launcher-Main"] floating enable
for_window [window_role="GtkFileChooserDialog"] resize set 800 600
for_window [window_role="GtkFileChooserDialog"] move position center
for_window [app_id="org.gnome.Nautilus"] floating enable
for_window [app_id="thunar"] floating enable
for_window [app_id="file-roller"] floating enable
for_window [title="Default - Wine desktop"] floating enable
for_window [class="Blender" title="^Blender Preferences$"] floating enable
for_window [app_id="firefox" title="^Picture-in-Picture$"] floating enable, move position 877 450, sticky enable
for_window [app_id="firefox" title="^Firefox - Sharing Indicator$"] floating enable, move position bottom, move position right, sticky enable
# for_window [app_id="firefox"] move workspace $workspace2
for_window [app_id="blueman-*"] floating enable, sticky enable
for_window [app_id="wdisplays"] floating enable, resize 780 415, move position center, sticky enable
for_window [title="dropdown_dropdowncalc"] resize set 800 300
# for_window [title="dropdown_dropdowncalc"] border csd
for_window [title="dropdown_dropdowncalc"] move position cursor

for_window [app_id="virt-manager"] floating enable, sticky enable
for_window [app_id="openrgb"] floating enable, sticky enable
for_window [app_id="org.pwmt.zathura"] floating enable, sticky enable, move position bottom
for_window [app_id="zoom"] floating enable

## $$$$$$$$$$$$$$$$$$$$$ MOVE TO WORK SPACE $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ ##
# for_window [class="discord"] move workspace $workspace5
for_window [app_id="evolution"] move workspace 6

# #---Dropdown Windows---# #
# General dropdown window traits. The order can matter.
for_window [title="^float*"] floating enable
for_window [title="dropdown_*"] floating enable
for_window [title="dropdown_*"] move scratchpad
for_window [title="dropdown_*"] sticky enable
#for_window [title="dropdown_*"] scratchpad show
# Dropdown for fzfmenu
for_window [title="fzfmenu"] floating enable, sticky
for_window [title="fzfmenu"] resize set 600 200
# skim launcher
for_window [title="^skim launcher$"] floating enable, sticky
for_window [title="^skim launcher$"] resize set 600 350

# FLOATING TERMINAL
# bindsym $mod+d exec $TERMINAL -t "fzfmenu" -e fzfmenu
bindsym $mod+d exec $TERMINAL -t "skim launcher" -e skim_switcher
bindsym $mod+Shift+minus move scratchpad
bindsym $mod+minus scratchpad show


# change container layout (stacked, tabbed, toggle split)
#bindsym $mod+s layout stacking
#bindsym $mod+w layout tabbed
#bindsym $mod+e layout toggle split

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle
bindsym $mod+space		focus mode_toggle
bindsym $mod+t			split toggle

set $workspace1 1
set $workspace2 2
set $workspace3 3
set $workspace4 4
set $workspace5 5
set $workspace6 6
set $workspace7 7
set $workspace8 8
set $workspace9 9
set $workspace10 10

workspace 1 output DP-1
workspace 2 output DP-1
workspace 3 output DP-1
workspace 4 output DP-1

workspace 5 output HDMI-A-1
workspace 6 output HDMI-A-1


# switch to workspace
#bindsym $mod+Tab workspace next
#bindsym $mod+Shift+Tab workspace prev
bindsym $mod+Tab workspace back_and_forth
# bindsym Alt+Tab workspace next
# bindsym Alt+Shift+Tab workspace prev
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9
bindsym $mod+Shift+0 move container to workspace number 10

# reload the configuration file
bindsym $mod+Shift+c reload
bindsym $mod+F2 restart
# exit i3 (logs you out of your X session)
# bindsym $mod+Shift+Escape 	exec --no-startup-id swaynag "Exit i3?" "swaymsg exit"
bindsym $mod+Shift+Escape       exec --no-startup-id swaynag -m "Exit sway?" -b "EXIT" "swaymsg exit"

# Audio keys

bindsym XF86AudioMute exec pamixer --toggle-mute && ( pamixer --get-mute && echo 0 > $SWAYSOCK.wob ) || pamixer --get-volume > $SWAYSOCK.wob
bindsym XF86AudioLowerVolume exec pamixer -ud 5 && pamixer --get-volume > $SWAYSOCK.wob
bindsym XF86AudioRaiseVolume exec pamixer -ui 5 && pamixer --get-volume > $SWAYSOCK.wob
bindsym $mod+Ctrl+0 exec pamixer --toggle-mute && ( pamixer --get-mute && echo 0 > $SWAYSOCK.wob ) || pamixer --get-volume > $SWAYSOCK.wob
bindsym $mod+Ctrl+8 exec pamixer -ud 5 && pamixer --get-volume > $SWAYSOCK.wob
bindsym $mod+Ctrl+9 exec pamixer -ui 5 && pamixer --get-volume > $SWAYSOCK.wob
bindsym XF86AudioPlay exec playerctl play-pause
bindsym XF86AudioPause exec playerctl play-pause
bindsym Menu+Up exec playerctl play-pause
bindsym Menu+Right exec playerctl next
bindsym Menu+Left exec playerctl previous

# Brightness keys
bindsym XF86MonBrightnessUp exec light -A 10
bindsym XF86MonBrightnessDown exec light -U 10

# Setup gaps
smart_gaps on
# gaps top 5
# gaps horizontal 10
# gaps inner 30
# gaps outer 100

# bind gaps
bindsym $mod+Shift+t		gaps inner current set 5; gaps outer current set 0
bindsym $mod+Shift+d		gaps inner current set 0; gaps outer current set 0

# Border border
default_border none
for_window [class="^.*"] pixel 0
for_window [app_id="^.*"] pixel 0
# for_window [class="^.*"] border csd
# for_window [app_id="^.*"] border csd
for_window [app_id="Alacritty"] border pixel 0
for_window [title="float"] floating enable
for_window [class="^.float"] floating enable

set $bg-color            $background
set $bd-color            #98C379
set $inactive-bg-color   #383C4A
set $inactive-bd-color   #F4D669
set $text-color          #f3f4f5
set $inactive-text-color #676E7D
set $indicator-color 	 #98f379

bar {
    swaybar_command waybar
}
output "*" bg "$HOME/.config/wall.png" fill
# output DP-1 mode 2560x1440@143.912003Hz
output DP-1 mode 2560x1440@143.912003Hz adaptive_sync off
output DP-1 pos 0 0
output HDMI-A-1 pos 2560 0


# https://github.com/Big-B/swaylock-fancy
bindsym $mod+x exec swaylock --screenshots --clock --indicator --indicator-radius 100 --indicator-thickness 7 --effect-blur 7x5 --effect-vignette 0.5:0 --ring-color bb00cc --key-hl-color 880033 --line-color 00000000 --inside-color 00000088 --separator-color 00000000 --grace 10 --fade-in 0.3

# Auto start
# exec swayidle -w \
#         timeout 300 'swaylock --screenshots --clock --indicator --indicator-radius 100 --indicator-thickness 7 --effect-blur 7x5 --effect-vignette 0.5:0 --ring-color bb00cc --key-hl-color 880033 --line-color 00000000 --inside-color 00000088 --separator-color 00000000 --grace 10 --fade-in 0.3' \
#         timeout 350 'swaymsg "output * dpms off"' \
#             resume 'swaymsg "output * dpms on"' \
#         before-sleep 'swaylock --screenshots --clock --indicator --indicator-radius 100 --indicator-thickness 7 --effect-blur 7x5 --effect-vignette 0.5:0 --ring-color bb00cc --key-hl-color 880033 --line-color 00000000 --inside-color 00000088 --separator-color 00000000 --grace 10 --fade-in 0.3'

## Services
exec_always autolog mako
exec autolog mopidy
exec autolog syncthing -no-browser
exec autolog /usr/lib/kdeconnectd
exec autolog kdeconnect-indicator
exec autolog redshift
exec autolog blueman-tray
exec autolog nm-applet --indicator
exec autolog xrdb -load ~/.config/.Xresources
exec autolog sway-alttab
# Screen sharing service
exec autolog /usr/lib/xdg-desktop-portal -r
exec autolog /usr/lib/xdg-desktop-portal-wlr -r
# # show volume
exec mkfifo $SWAYSOCK.wob && tail -f $SWAYSOCK.wob | wob -W 300 -H 30 -a top -a right -M 50 -p 1 -o 0 -b 1
exec autolog /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1
exec autolog keyring
# exec autolog waybar
exec autolog sworkstyle
exec autolog nwg-wrapper -s date-wttr.sh -r 1800000 -c date-wttr.css -p right -mr 200 -a start -mt 50 -j right


## Autostart applications
# exec autolog discord
# exec autolog evolution
# exec autolog ulauncher
exec autolog $BROWSER
